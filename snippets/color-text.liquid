{%- comment -%}
  Usage: Include text between [color:#HEX]text[/color] tags
  Example: Hello [color:#ff0000]World[/color]
{%- endcomment -%}

{%- assign text = text | default: content -%}
{%- assign parts = text | split: '[color:' -%}

{%- for part in parts -%}
  {%- if forloop.first and forloop.length == 1 -%}
    {{ part }}
  {%- else -%}
    {%- if forloop.first -%}
      {{ part }}
    {%- else -%}
      {%- assign color_split = part | split: ']' -%}
      {%- assign color = color_split.first -%}
      {%- assign content_split = color_split.last | split: '[/color]' -%}
      <span style="color: {{ color }}">{{ content_split.first }}</span>{{ content_split.last }}
    {%- endif -%}
  {%- endif -%}
{%- endfor -%}
